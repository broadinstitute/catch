language: python

jobs:
  include:
    - name: "Python 3.8 on Focal Linux"
      os: linux
      dist: focal
      python: 3.8
    - name: "Python 3.9 on Focal Linux"
      os: linux
      dist: focal
      python: 3.9
    - name: "Python on macOS"
      os: osx
      language: generic # needed for Travis on macOS
      osx_image: xcode13.4 # macOS 12.4
      before_install:
        - python3 --version

cache:
 directories:
  - $HOME/virtualenv

install:
 - pip3 install --upgrade pip
 - pip3 install -r requirements.txt || sudo pip3 install -r requirements.txt # try sudo, if needed on macOS
 - pip3 install coveralls[yaml] nose-cov || sudo pip3 install coveralls[yaml] nose-cov
 - python setup.py install --force || python3 setup.py install --force # try python, then python3

script:
 - nosetests -v --with-xunit --with-coverage --cover-inclusive --cover-branches --cover-package catch

after_success:
 - coveralls
